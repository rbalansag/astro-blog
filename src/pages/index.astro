---
import BaseLayout from "../layouts/BaseLayout.astro"
import Greeting from "../components/Greeting"
import { Image } from "@astrojs/image/components"
const pageTitle = "Home Page"

type Image = {
  title: string
  explanation: string
  media_type: "image" | "video"
  /** Date published in YYYY-MM-DD format */
  date: string
  /** Video URL or standard resolution image URL */
  url: string
  /** High-res image URL (for media_type: 'image' only) */
  hdurl?: string
  /** API version. Defaults to "v1" */
  service_version: string
}

const images: Image[] = await fetch(`https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY&count=5`).then((res) =>
  res.json()
)
---

<BaseLayout pageTitle={pageTitle}>
  <h2>Random Greeting using Preact</h2>
  <Greeting messages={["Hi", "Hello", "Howdy", "Hey there"]} />

  <h2>Images</h2>
  {
    images.map((image) => {
      if (image.media_type === "image") {
        return (
          <Image src={image.hdurl || image.url} width={400} height={300} title={image.title} alt={image.explanation} format="avif" />
        )
      }
    })
  }

</BaseLayout>
